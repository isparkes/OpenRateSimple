<?xml version="1.0"?>
<config>
  <!-- simplest possible processing pipeline -->
  <Application>
    Simple
  </Application>

  <PipelineList>
    <SimplePipe>
      <Active>True</Active>
      <HaltOnException>True</HaltOnException>
      <PipelineType>Batch</PipelineType>
    </SimplePipe>
  </PipelineList>

  <!-- this configuration tells OpenRate to only audit core classes, which
       means that CVS version information does not need to be put into the 
       application classes -->
  <OnlyAuditCoreClasses>
    True
  </OnlyAuditCoreClasses>
  
  <SimplePipe>
    <InputAdapter>
      <!-- read the input file, using pattern testpipeline*.edr, renaming to
           testpipeline*.done when done. In the case of a transaction rollback
           (unlikely), rename to testpipeline*.err. Rollbacks only occurr when
           record level processing cannot continue, usually triggered explicitly
           in your processing -->
      <SInpAdapter>
        <ClassName>Simple.SimpleInputAdapter</ClassName>
        <BatchSize>5000</BatchSize>
        <InputFilePath>Data/Simple</InputFilePath>
        <InputFilePrefix>testpipeline</InputFilePrefix>
        <InputFileSuffix>.edr</InputFileSuffix>
        <DoneFilePath>Data/Simple</DoneFilePath>
        <DoneFilePrefix>testpipeline</DoneFilePrefix>
        <DoneFileSuffix>.done</DoneFileSuffix>
        <ErrFilePath>Data/Simple</ErrFilePath>
        <ErrFilePrefix>testpipeline</ErrFilePrefix>
        <ErrFileSuffix>.err</ErrFileSuffix>
      </SInpAdapter>
     </InputAdapter>

    <!-- The "Process" section executes the modules in the order they are listed -->
    <Process>
      <!-- Dump out the diagnostics to file. This will create a dump file
           testpipeline*.dump.
           
           Valid values for DumpType are:
              All - Dump every record (Default)
              None - Dump no records
              Errors - Dump records with errors
              Flag - Dump records where we have set the dumping flag -->
      <DumpFirst>
        <ClassName>com.openrate.process.Dump</ClassName>
        <Active>True</Active>
        <DumpType>All</DumpType>
        <DumpFilePath>Data/Simple</DumpFilePath>
        <DumpFilePrefix>testpipeline</DumpFilePrefix>
        <DumpFileSuffix>.dump</DumpFileSuffix>
        <BatchSize>5000</BatchSize>
      </DumpFirst>
    </Process>

    <OutputAdapter>
      <!-- Write the output file, using pattern testpipeline*.out. In the case 
           of a transaction rollback, then the file will be renamed to 
           testpipeline*.err. -->
      <SOutAdapter>
        <ClassName>Simple.SimpleSTOutputAdapter</ClassName>
        <OutputName>default</OutputName>
        <BatchSize>5000</BatchSize>
        <MaxSleep>50</MaxSleep>
        <OutputFilePath>Data/Simple</OutputFilePath>
        <OutputFilePrefix>testpipeline</OutputFilePrefix>
        <OutputFileSuffix>.out</OutputFileSuffix>
        <ErrFilePath>Data/Simple</ErrFilePath>
        <ErrFilePrefix>testpipeline</ErrFilePrefix>
        <ErrFileSuffix>.err</ErrFileSuffix>
      </SOutAdapter>
    </OutputAdapter>
  </SimplePipe>

  <Resource>
    <ECI>
      <Port>8086</Port>
      <MaxConnection>2</MaxConnection>
    </ECI>

    <CacheFactory>
      <ClassName>OpenRate.resource.CacheFactory</ClassName>
      <CacheableClass>
        <PrefixCache>
          <ClassName>OpenRate.cache.BestMatchCache</ClassName>
          <DataSourceType>File</DataSourceType>
          <DataFile>ConfigData/Simple/prefixdesc.dat</DataFile>
        </PrefixCache>
      </CacheableClass>
    </CacheFactory>
  </Resource>
</config>
